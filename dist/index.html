<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>H78</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="stylesheet" href="98.css">
  <link rel="stylesheet" href="98-h78incs.css">
  <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/perfect-dos-vga-437">
  <link rel="stylesheet" href="style.css">
  <script src="emulators.js"></script>
  <script src="emulators-ui.js"></script>
  <link rel="stylesheet" href="emulators-ui.css">
</head>
<body>
  <div class="window">
    <div class="title-bar-text title-bar-text-with-icon">
      <img src="ms_dos-1.png" alt="DOS Icon" class="icon">
        <span>MS-DOS Prompt</span>
        <button aria-label="Help"></button>
        <button aria-label="Close"></button>
      </div>
    </div>

    <div class="window-body">
      <div id="doom-container"></div>
      <script>
        emulators.pathPrefix = "";
        window.dos = Dos(document.getElementById("doom-container"));
        window.dos.run("doom.jsdos");
      </script>
    </div>

    <div class="status-bar">
      <p class="status-bar-field">Status: OK</p>
      <p class="status-bar-field">h78.co.uk</p>
    </div>
  </div>

  <script>
      document.querySelector('.title-bar-controls button[aria-label="Close"]').addEventListener('click', () => {      
        window.dos.stop();
        document.body.className = 'crt-mode';
        document.body.innerHTML = `
        <div class="crt">
A fatal exception 0E has occurred at 0028:C000BEEF in DOOM.EXE +
0000DEAD. The current application will be terminated.

*  Press any key to terminate the current application.
*  Press CTRL+ALT+DEL again to restart your computer. You will
   lose any unsaved information in all applications.

Press any key to continue _
        </div>
      `;

        setTimeout(() => {
      const refreshOnInteraction = () => {
        location.reload();
      };

      document.addEventListener('keydown', refreshOnInteraction, { once: true });
      document.addEventListener('click', refreshOnInteraction, { once: true });
      document.addEventListener('touchstart', refreshOnInteraction, { once: true });
    }, 1000); // 1 second delay
  });
  </script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const helpButton = document.querySelector('.title-bar-controls button[aria-label="Help"]');
    const container = document.getElementById("doom-container");

    if (helpButton && container) {
      helpButton.addEventListener('click', () => {
        window.dos.stop();
        container.innerHTML = "<p>Hello World!</p>";
        container.className = "window-body";
      });
    }
  });
</script>

  
</body>
</html>
